# 이상탐지란 무엇인가?



## 1. 이상탐지 개념

- 이상탐지란 데이터 마이님을 기반으로 한 데이터 분석 기법 중 하나로, 이상치를 탐지하는 기법이다. 
- 이상탐지는 IT 보안, 의료진단, 제조공정의 크랙찾기, 금융 데이터 등의 이상치를 찾는데 활용되고있다.



## 2. 지도 학습에 기반한 이상탐지

- 알고리즘
  - k-NN, 랜덤 포레스트 등
- 지도 학습의 이상탐지 평가
  - 비지도 학습과 다르게 실무에 적용되기 어려운 기법.
  - 이상 데이터는 정상 데이터와 비교했을 때 수가 적고 불균형이기 때문에 지도학습으로 판별하기 어렵다.
  - 정황상 이상치가 맞더라도 판별할 관측 데이터가 없는 경우 결과적으로 알아낼 수 없다.



## 3. 비지도 학습에 기반한 이상탐지



### 1) 알고리즘



#### (1) 비지도 학습 모델(차원축소)

- Principal Component Analysis (PCA, 선형)
  - 데이터의 변동성을 설명하는 feature을 찾는데 유용한 방법
  - Incremental PCA, Kernel PCA, Sparse PCA 등 여러가지 PCA 기법이 존재한다.
- Singular Value Decomposition (SVD, 선형)
  - 원래 행렬의 차원을 적은 차원으로 줄여 더 작은 차원의 행렬에서 일부 벡터의 선형 결합을 사용해 원래 행렬을 다시 만들 수 있도록 한다.
- t-distributed stochastic neighbor embedding (t-SNE, 비선형)
  - 고차원의 데이터간 거리를 저차원으로 축소하였을 때, 똑같이 유지하는 방법.
  - 원 공간에서 가까운 점들도 고려하고, 좀 더 멀리 있는 점들의 위치도 고려하는 방법이다.
- Autoencoder (비선형)
  - 비지도 학습 기반의 대표적인 방법
  -  입력 샘플을 인코더를 통해 저차원으로 압축 시키고, 디코더 과정을 거쳐서 다시 원래의 차원으로 복원하는 방법
  - 입력 샘플과 복원 샘플의 복원 오차 (reconstruction error)를 산출할 수 있다.



#### (2) 비지도 학습 모델(클러스터링)

- LOF (Local Outlier Factor)
  - local 이상값을 찾기 위해 설계된 밀도 기반 방법
    1. 각 데이터 포인트에 대해 NN 계산
    2. 계산된 이웃을 사용하여 로컬 밀도 계산 (LRD)
    3. 데이터 포인트의 LRD와 이전에 계산된 NN의 LRD 비교하여 LOF 계산해서 다른 개체보다 밀도가 낮게 특정 되는 데이터를 이상치로 판단
- K-means
  - 데이터를 특성에 따라 k개의 그룹으로 클러스터링하는 알고리즘입니다. 클러스터의 중심에서 멀리 떨어진 데이터는 비정상 데이터로 판단
- rPCA (Robust Principal Component Analysis)
  - 차원을 축소하고 복원을 하는 과정을 통해 비정상 sample을 검출하는 방법
  - 데이터를 더 낮은 차원의 부분공간으로 보내면 그 공간에서는 정상과 이상이 구분된다고 가정
- Isolation Forest
  - 비정상 데이터는 의사결정나무의 루트에서 가까운 깊이에 고립 될 것이라고 가정
  - leaf 노드 까지의 거리를 outlier score로 정의하고, 평균 거리가 짧을 수록 outlier일 가능성이 크다고 판단
- One Class SVM
  - 정상 데이터를 원점으로부터 최대한 멀리 위치하게 만드는 초평면(Hyperplane)을 찾고, 새로운 데이터가 원점과 초평면 사이에 위치하면 이상치 데이터로 판별
- Angle Based Outlier detection (ABOD)
  - 각도 기반 이상치 감지 알고리즘
  - 데이터 포인트와 다른 포인트 사이의 각도 분산을 이상 점수로 이용



#### (3) 비지도 학습의 이상탐지 평가

- 레이블을 사용할 수 없어 AI 에이전트의 작업이 명확히 정의되지 않는다.
- 단, 엄격한 룰이 없기 때문에 흥미로운 패턴을 찾아내고 더 강력한 탐지를 수행할 수 있다.

